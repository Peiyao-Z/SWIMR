% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SWIMRMultiRef.R
\name{SWIMRMultiRef}
\alias{SWIMRMultiRef}
\title{Multi-reference spatial deconvolution (SWIMR C++ core)}
\usage{
SWIMRMultiRef(
  YinputIn,
  SListIn,
  KIn,
  phi1In,
  phi2In,
  max_iterIn,
  epsilonIn,
  initPList,
  initsMatList,
  initSigma_e2,
  initLambdaList,
  initZ
)
}
\arguments{
\item{YinputIn}{A numeric matrix (genes × spots): normalized spatial counts.}

\item{SListIn}{A list of basis matrices `S_r` (genes × K_r), one per reference.}

\item{KIn}{A numeric matrix (spots × spots): spatial affinity/adjacency (e.g., Gaussian kernel).}

\item{phi1In, phi2In}{Numeric scalars: CAR strength parameters for P and Z, respectively.}

\item{max_iterIn}{Integer: maximum iterations.}

\item{epsilonIn}{Numeric: relative tolerance for convergence check.}

\item{initPList}{A list of initial proportion matrices `P_r` (spots × K_r).}

\item{initsMatList}{A list of initial intercept vectors `s_rk` (length K_r) per reference.}

\item{initSigma_e2}{Numeric scalar: initial residual variance.}

\item{initLambdaList}{A list of initial smoothing scales `lambda_rk` (length K_r) per reference.}

\item{initZ}{A numeric matrix (spots × R): initial location weights per reference.}
}
\value{
A list with elements:
\itemize{
  \item \code{PList}: updated list of cell-type proportions per reference.
  \item \code{Z}: updated (spots × R) location weights.
  \item \code{sigma_e2}: estimated residual variance.
  \item \code{lambda}: updated list of \eqn{\lambda_{rk}} per reference.
  \item \code{sMatList}: updated list of intercept vectors per reference.
  \item \code{Obj}: final objective value.
}
}
\description{
Runs the SWIMR multi-reference Conditional Autoregressive (CAR) model to
jointly estimate cell-type compositions per reference and location weights.
}
